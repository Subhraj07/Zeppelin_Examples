{
  "paragraphs": [
    {
      "text": "%sh\n\nwget -O apache.access.log.PROJECT.gz https://www.dropbox.com/s/n13homy2ssyd1n2/apache.access.log.PROJECT.gz?dl\u003d0\n\nrm -f apache.access.log.PROJECT\ngunzip apache.access.log.PROJECT.gz",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:40:24 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "--2018-02-19 03:40:25--  https://www.dropbox.com/s/n13homy2ssyd1n2/apache.access.log.PROJECT.gz?dl\u003d0\nResolving www.dropbox.com... 162.125.6.1, 2620:100:601c:1::a27d:601\nConnecting to www.dropbox.com|162.125.6.1|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLocation: https://dl.dropboxusercontent.com/content_link/8X0geWnWUN5jlDN71dXYF4Z7A1FB5ZMLQ9zm7gzRe0cAaT1s4tVgynWpJhqwgChP/file [following]\n--2018-02-19 03:40:32--  https://dl.dropboxusercontent.com/content_link/8X0geWnWUN5jlDN71dXYF4Z7A1FB5ZMLQ9zm7gzRe0cAaT1s4tVgynWpJhqwgChP/file\nResolving dl.dropboxusercontent.com... 162.125.6.6, 2620:100:601c:6::a27d:606\nConnecting to dl.dropboxusercontent.com|162.125.6.6|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11124290 (11M) [application/octet-stream]\nSaving to: “apache.access.log.PROJECT.gz”\n\n     0K .......... .......... .......... .......... ..........  0%  124K 87s\n    50K .......... .......... .......... .......... ..........  0%  533K 53s\n   100K .......... .......... .......... .......... ..........  1%  268K 49s\n   150K .......... .......... .......... .......... ..........  1%  292K 46s\n   200K .......... .......... .......... .......... ..........  2% 2.28M 37s\n   250K .......... .......... .......... .......... ..........  2% 1.38M 32s\n   300K .......... .......... .......... .......... ..........  3%  305K 32s\n   350K .......... .......... .......... .......... ..........  3% 1.79M 29s\n   400K .......... .......... .......... .......... ..........  4% 1.88M 26s\n   450K .......... .......... .......... .......... ..........  4% 3.27M 24s\n   500K .......... .......... .......... .......... ..........  5%  329K 24s\n   550K .......... .......... .......... .......... ..........  5% 2.06M 23s\n   600K .......... .......... .......... .......... ..........  5% 2.03M 21s\n   650K .......... .......... .......... .......... ..........  6% 2.79M 20s\n   700K .......... .......... .......... .......... ..........  6% 3.14M 19s\n   750K .......... .......... .......... .......... ..........  7% 2.78M 18s\n   800K .......... .......... .......... .......... ..........  7% 2.72M 17s\n   850K .......... .......... .......... .......... ..........  8% 4.12M 16s\n   900K .......... .......... .......... .......... ..........  8%  643K 16s\n   950K .......... .......... .......... .......... ..........  9%  935K 15s\n  1000K .......... .......... .......... .......... ..........  9% 3.47M 15s\n  1050K .......... .......... .......... .......... .......... 10% 2.73M 14s\n  1100K .......... .......... .......... .......... .......... 10% 3.70M 14s\n  1150K .......... .......... .......... .......... .......... 11% 2.93M 13s\n  1200K .......... .......... .......... .......... .......... 11% 4.43M 13s\n  1250K .......... .......... .......... .......... .......... 11% 4.34M 12s\n  1300K .......... .......... .......... .......... .......... 12% 4.69M 12s\n  1350K .......... .......... .......... .......... .......... 12% 1.09M 11s\n  1400K .......... .......... .......... .......... .......... 13% 4.19M 11s\n  1450K .......... .......... .......... .......... .......... 13% 5.63M 11s\n  1500K .......... .......... .......... .......... .......... 14% 5.62M 10s\n  1550K .......... .......... .......... .......... .......... 14% 4.28M 10s\n  1600K .......... .......... .......... .......... .......... 15% 5.91M 10s\n  1650K .......... .......... .......... .......... .......... 15% 5.48M 9s\n  1700K .......... .......... .......... .......... .......... 16% 5.08M 9s\n  1750K .......... .......... .......... .......... .......... 16% 7.25M 9s\n  1800K .......... .......... .......... .......... .......... 17% 4.85M 9s\n  1850K .......... .......... .......... .......... .......... 17% 4.34M 8s\n  1900K .......... .......... .......... .......... .......... 17% 8.07M 8s\n  1950K .......... .......... .......... .......... .......... 18% 5.11M 8s\n  2000K .......... .......... .......... .......... .......... 18% 5.70M 8s\n  2050K .......... .......... .......... .......... .......... 19% 5.20M 8s\n  2100K .......... .......... .......... .......... .......... 19% 6.22M 7s\n  2150K .......... .......... .......... .......... .......... 20% 5.79M 7s\n  2200K .......... .......... .......... .......... .......... 20% 5.77M 7s\n  2250K .......... .......... .......... .......... .......... 21% 5.86M 7s\n  2300K .......... .......... .......... .......... .......... 21% 5.88M 7s\n  2350K .......... .......... .......... .......... .......... 22% 4.00M 7s\n  2400K .......... .......... .......... .......... .......... 22% 6.79M 6s\n  2450K .......... .......... .......... .......... .......... 23% 5.64M 6s\n  2500K .......... .......... .......... .......... .......... 23% 6.17M 6s\n  2550K .......... .......... .......... .......... .......... 23% 4.69M 6s\n  2600K .......... .......... .......... .......... .......... 24% 12.2M 6s\n  2650K .......... .......... .......... .......... .......... 24% 8.51M 6s\n  2700K .......... .......... .......... .......... .......... 25% 7.68M 6s\n  2750K .......... .......... .......... .......... .......... 25% 7.10M 6s\n  2800K .......... .......... .......... .......... .......... 26% 6.37M 5s\n  2850K .......... .......... .......... .......... .......... 26% 8.78M 5s\n  2900K .......... .......... .......... .......... .......... 27% 5.58M 5s\n  2950K .......... .......... .......... .......... .......... 27% 12.7M 5s\n  3000K .......... .......... .......... .......... .......... 28% 9.63M 5s\n  3050K .......... .......... .......... .......... .......... 28% 8.56M 5s\n  3100K .......... .......... .......... .......... .......... 28% 8.55M 5s\n  3150K .......... .......... .......... .......... .......... 29% 6.45M 5s\n  3200K .......... .......... .......... .......... .......... 29% 7.85M 5s\n  3250K .......... .......... .......... .......... .......... 30% 4.03M 5s\n  3300K .......... .......... .......... .......... .......... 30% 4.90M 5s\n  3350K .......... .......... .......... .......... .......... 31%  116K 5s\n  3400K .......... .......... .......... .......... .......... 31% 26.1M 5s\n  3450K .......... .......... .......... .......... .......... 32% 1.73M 5s\n  3500K .......... .......... .......... .......... .......... 32% 10.7M 5s\n  3550K .......... .......... .......... .......... .......... 33% 33.8M 5s\n  3600K .......... .......... .......... .......... .......... 33% 7.60M 5s\n  3650K .......... .......... .......... .......... .......... 34% 38.4M 5s\n  3700K .......... .......... .......... .......... .......... 34%  209K 5s\n  3750K .......... .......... .......... .......... .......... 34%  222M 5s\n  3800K .......... .......... .......... .......... .......... 35%  344M 5s\n  3850K .......... .......... .......... .......... .......... 35% 31.5M 5s\n  3900K .......... .......... .......... .......... .......... 36% 30.5M 5s\n  3950K .......... .......... .......... .......... .......... 36%  167M 5s\n  4000K .......... .......... .......... .......... .......... 37%  266M 5s\n  4050K .......... .......... .......... .......... .......... 37%  272K 5s\n  4100K .......... .......... .......... .......... .......... 38% 10.2M 5s\n  4150K .......... .......... .......... .......... .......... 38% 25.0M 5s\n  4200K .......... .......... .......... .......... .......... 39% 10.0M 5s\n  4250K .......... .......... .......... .......... .......... 39% 22.6M 4s\n  4300K .......... .......... .......... .......... .......... 40% 7.56M 4s\n  4350K .......... .......... .......... .......... .......... 40% 12.0M 4s\n  4400K .......... .......... .......... .......... .......... 40% 35.8M 4s\n  4450K .......... .......... .......... .......... .......... 41%  312M 4s\n  4500K .......... .......... .......... .......... .......... 41%  318M 4s\n  4550K .......... .......... .......... .......... .......... 42%  242M 4s\n  4600K .......... .......... .......... .......... .......... 42% 65.4M 4s\n  4650K .......... .......... .......... .......... .......... 43% 17.4M 4s\n  4700K .......... .......... .......... .......... .......... 43% 42.4M 4s\n  4750K .......... .......... .......... .......... .......... 44% 25.8M 4s\n  4800K .......... .......... .......... .......... .......... 44% 24.0M 4s\n  4850K .......... .......... .......... .......... .......... 45% 16.6M 4s\n  4900K .......... .......... .......... .......... .......... 45%  521K 4s\n  4950K .......... .......... .......... .......... .......... 46% 13.9M 4s\n  5000K .......... .......... .......... .......... .......... 46% 8.51M 4s\n  5050K .......... .......... .......... .......... .......... 46% 32.5M 3s\n  5100K .......... .......... .......... .......... .......... 47%  288M 3s\n  5150K .......... .......... .......... .......... .......... 47% 58.7M 3s\n  5200K .......... .......... .......... .......... .......... 48%  162M 3s\n  5250K .......... .......... .......... .......... .......... 48% 54.4M 3s\n  5300K .......... .......... .......... .......... .......... 49% 35.9M 3s\n  5350K .......... .......... .......... .......... .......... 49% 74.8M 3s\n  5400K .......... .......... .......... .......... .......... 50% 6.61M 3s\n  5450K .......... .......... .......... .......... .......... 50% 6.99M 3s\n  5500K .......... .......... .......... .......... .......... 51% 5.54M 3s\n  5550K .......... .......... .......... .......... .......... 51% 6.64M 3s\n  5600K .......... .......... .......... .......... .......... 52% 8.11M 3s\n  5650K .......... .......... .......... .......... .......... 52% 7.57M 3s\n  5700K .......... .......... .......... .......... .......... 52% 7.00M 3s\n  5750K .......... .......... .......... .......... .......... 53% 6.44M 3s\n  5800K .......... .......... .......... .......... .......... 53% 5.13M 3s\n  5850K .......... .......... .......... .......... .......... 54% 6.95M 3s\n  5900K .......... .......... .......... .......... .......... 54% 7.11M 3s\n  5950K .......... .......... .......... .......... .......... 55% 7.04M 3s\n  6000K .......... .......... .......... .......... .......... 55% 4.81M 3s\n  6050K .......... .......... .......... .......... .......... 56% 7.91M 2s\n  6100K .......... .......... .......... .......... .......... 56% 5.71M 2s\n  6150K .......... .......... .......... .......... .......... 57% 9.18M 2s\n  6200K .......... .......... .......... .......... .......... 57% 6.88M 2s\n  6250K .......... .......... .......... .......... .......... 57% 6.10M 2s\n  6300K .......... .......... .......... .......... .......... 58% 6.04M 2s\n  6350K .......... .......... .......... .......... .......... 58% 4.45M 2s\n  6400K .......... .......... .......... .......... .......... 59% 5.90M 2s\n  6450K .......... .......... .......... .......... .......... 59% 6.82M 2s\n  6500K .......... .......... .......... .......... .......... 60% 10.0M 2s\n  6550K .......... .......... .......... .......... .......... 60% 22.7M 2s\n  6600K .......... .......... .......... .......... .......... 61% 8.08M 2s\n  6650K .......... .......... .......... .......... .......... 61% 6.76M 2s\n  6700K .......... .......... .......... .......... .......... 62% 7.41M 2s\n  6750K .......... .......... .......... .......... .......... 62% 4.97M 2s\n  6800K .......... .......... .......... .......... .......... 63% 5.84M 2s\n  6850K .......... .......... .......... .......... .......... 63% 7.50M 2s\n  6900K .......... .......... .......... .......... .......... 63% 7.62M 2s\n  6950K .......... .......... .......... .......... .......... 64% 6.38M 2s\n  7000K .......... .......... .......... .......... .......... 64% 6.42M 2s\n  7050K .......... .......... .......... .......... .......... 65%  229K 2s\n  7100K .......... .......... .......... .......... .......... 65% 5.38M 2s\n  7150K .......... .......... .......... .......... .......... 66% 8.21M 2s\n  7200K .......... .......... .......... .......... .......... 66% 17.1M 2s\n  7250K .......... .......... .......... .......... .......... 67% 9.10M 2s\n  7300K .......... .......... .......... .......... .......... 67% 8.28M 2s\n  7350K .......... .......... .......... .......... .......... 68% 5.55M 2s\n  7400K .......... .......... .......... .......... .......... 68% 12.3M 2s\n  7450K .......... .......... .......... .......... .......... 69% 16.3M 2s\n  7500K .......... .......... .......... .......... .......... 69% 4.81M 2s\n  7550K .......... .......... .......... .......... .......... 69% 11.5M 2s\n  7600K .......... .......... .......... .......... .......... 70% 9.36M 2s\n  7650K .......... .......... .......... .......... .......... 70% 7.31M 1s\n  7700K .......... .......... .......... .......... .......... 71% 5.88M 1s\n  7750K .......... .......... .......... .......... .......... 71% 4.82M 1s\n  7800K .......... .......... .......... .......... .......... 72% 10.8M 1s\n  7850K .......... .......... .......... .......... .......... 72% 10.6M 1s\n  7900K .......... .......... .......... .......... .......... 73% 19.7M 1s\n  7950K .......... .......... .......... .......... .......... 73% 15.4M 1s\n  8000K .......... .......... .......... .......... .......... 74% 48.8M 1s\n  8050K .......... .......... .......... .......... .......... 74% 25.3M 1s\n  8100K .......... .......... .......... .......... .......... 75% 47.8M 1s\n  8150K .......... .......... .......... .......... .......... 75% 31.0M 1s\n  8200K .......... .......... .......... .......... .......... 75% 36.2M 1s\n  8250K .......... .......... .......... .......... .......... 76% 23.0M 1s\n  8300K .......... .......... .......... .......... .......... 76% 10.6M 1s\n  8350K .......... .......... .......... .......... .......... 77% 4.35M 1s\n  8400K .......... .......... .......... .......... .......... 77% 17.7M 1s\n  8450K .......... .......... .......... .......... .......... 78%  607K 1s\n  8500K .......... .......... .......... .......... .......... 78%  237K 1s\n  8550K .......... .......... .......... .......... .......... 79% 14.6M 1s\n  8600K .......... .......... .......... .......... .......... 79% 78.9M 1s\n  8650K .......... .......... .......... .......... .......... 80% 53.9M 1s\n  8700K .......... .......... .......... .......... .......... 80%  107M 1s\n  8750K .......... .......... .......... .......... .......... 81%  256M 1s\n  8800K .......... .......... .......... .......... .......... 81%  359M 1s\n  8850K .......... .......... .......... .......... .......... 81% 51.0M 1s\n  8900K .......... .......... .......... .......... .......... 82%  268M 1s\n  8950K .......... .......... .......... .......... .......... 82%  316M 1s\n  9000K .......... .......... .......... .......... .......... 83% 22.7M 1s\n  9050K .......... .......... .......... .......... .......... 83%  778K 1s\n  9100K .......... .......... .......... .......... .......... 84% 5.06M 1s\n  9150K .......... .......... .......... .......... .......... 84%  123M 1s\n  9200K .......... .......... .......... .......... .......... 85% 79.3M 1s\n  9250K .......... .......... .......... .......... .......... 85% 90.8M 1s\n  9300K .......... .......... .......... .......... .......... 86% 32.1M 1s\n  9350K .......... .......... .......... .......... .......... 86% 13.7M 1s\n  9400K .......... .......... .......... .......... .......... 86% 21.6M 1s\n  9450K .......... .......... .......... .......... .......... 87% 48.9M 1s\n  9500K .......... .......... .......... .......... .......... 87% 37.4M 1s\n  9550K .......... .......... .......... .......... .......... 88% 57.1M 1s\n  9600K .......... .......... .......... .......... .......... 88% 92.1M 1s\n  9650K .......... .......... .......... .......... .......... 89% 77.4M 0s\n  9700K .......... .......... .......... .......... .......... 89% 69.4M 0s\n  9750K .......... .......... .......... .......... .......... 90%  480K 0s\n  9800K .......... .......... .......... .......... .......... 90% 18.9M 0s\n  9850K .......... .......... .......... .......... .......... 91% 20.0M 0s\n  9900K .......... .......... .......... .......... .......... 91% 58.3M 0s\n  9950K .......... .......... .......... .......... .......... 92% 8.10M 0s\n 10000K .......... .......... .......... .......... .......... 92% 18.7M 0s\n 10050K .......... .......... .......... .......... .......... 92% 14.2M 0s\n 10100K .......... .......... .......... .......... .......... 93% 26.1M 0s\n 10150K .......... .......... .......... .......... .......... 93% 36.3M 0s\n 10200K .......... .......... .......... .......... .......... 94% 32.2M 0s\n 10250K .......... .......... .......... .......... .......... 94% 12.7M 0s\n 10300K .......... .......... .......... .......... .......... 95% 17.3M 0s\n 10350K .......... .......... .......... .......... .......... 95% 28.4M 0s\n 10400K .......... .......... .......... .......... .......... 96% 19.0M 0s\n 10450K .......... .......... .......... .......... .......... 96% 45.9M 0s\n 10500K .......... .......... .......... .......... .......... 97% 25.0M 0s\n 10550K .......... .......... .......... .......... .......... 97% 37.0M 0s\n 10600K .......... .......... .......... .......... .......... 98% 78.6M 0s\n 10650K .......... .......... .......... .......... .......... 98% 82.6M 0s\n 10700K .......... .......... .......... .......... .......... 98% 68.7M 0s\n 10750K .......... .......... .......... .......... .......... 99% 50.1M 0s\n 10800K .......... .......... .......... .......... .......... 99% 42.5M 0s\n 10850K .......... ...                                        100% 18.7M\u003d4.2s\n\n2018-02-19 03:40:44 (2.53 MB/s) - “apache.access.log.PROJECT.gz” saved [11124290/11124290]\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040365206_-128432200",
      "id": "20180219-033925_1495526466",
      "dateCreated": "Feb 19, 2018 3:39:25 AM",
      "dateStarted": "Feb 19, 2018 3:40:24 AM",
      "dateFinished": "Feb 19, 2018 3:40:44 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nhdfs dfs -rm -f -skipTrash /tmp/apache.access.log.PROJECT\nhdfs dfs -put apache.access.log.PROJECT /tmp\nhdfs dfs -ls /tmp/apache.access.log.PROJECT\n",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:41:07 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "-rw-r--r--   1 cloudera supergroup  111503503 2018-02-19 03:41 /tmp/apache.access.log.PROJECT\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040424532_-1113111905",
      "id": "20180219-034024_647099533",
      "dateCreated": "Feb 19, 2018 3:40:24 AM",
      "dateStarted": "Feb 19, 2018 3:41:07 AM",
      "dateFinished": "Feb 19, 2018 3:41:29 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark\n\nsc\nsqlContext\n",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:43:34 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res1: org.apache.spark.SparkContext \u003d org.apache.spark.SparkContext@2ec43ef9\nres2: org.apache.spark.sql.SQLContext \u003d org.apache.spark.sql.hive.HiveContext@6f3ef1d4\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040467405_320724653",
      "id": "20180219-034107_1986255030",
      "dateCreated": "Feb 19, 2018 3:41:07 AM",
      "dateStarted": "Feb 19, 2018 3:43:34 AM",
      "dateFinished": "Feb 19, 2018 3:43:37 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nimport datetime\n\n# Quick test of the datetime library\nprint \u0027This was last run on: {0}\u0027.format(datetime.datetime.now())",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:43:54 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "This was last run on: 2018-02-19 03:43:54.479561\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040614761_-2136696697",
      "id": "20180219-034334_2042991995",
      "dateCreated": "Feb 19, 2018 3:43:34 AM",
      "dateStarted": "Feb 19, 2018 3:43:54 AM",
      "dateFinished": "Feb 19, 2018 3:43:54 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n# Quick test of regexp library\nimport re\n\n# Quick test of the regular expression library\nm \u003d re.search(\u0027(?\u003c\u003dabc)def\u0027, \u0027abcdef\u0027)\n\nprint m.group(0)",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:44:11 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "def\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040634036_526950587",
      "id": "20180219-034354_841355190",
      "dateCreated": "Feb 19, 2018 3:43:54 AM",
      "dateStarted": "Feb 19, 2018 3:44:11 AM",
      "dateFinished": "Feb 19, 2018 3:44:12 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nimport sys\nimport os\n\nlog_file_path \u003d \u0027hdfs:///\u0027 + os.path.join(\u0027tmp\u0027, \u0027apache.access.log.PROJECT\u0027)\n\nprint log_file_path",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:44:40 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "hdfs:///tmp/apache.access.log.PROJECT\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040651489_1956723472",
      "id": "20180219-034411_1724646801",
      "dateCreated": "Feb 19, 2018 3:44:11 AM",
      "dateStarted": "Feb 19, 2018 3:44:40 AM",
      "dateFinished": "Feb 19, 2018 3:44:40 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nbase_df \u003d  sqlContext.read.text(log_file_path)\n# Let\u0027s look at the schema\nbase_df.printSchema()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:44:55 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- value: string (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040680248_1634535401",
      "id": "20180219-034440_636673125",
      "dateCreated": "Feb 19, 2018 3:44:40 AM",
      "dateStarted": "Feb 19, 2018 3:44:55 AM",
      "dateFinished": "Feb 19, 2018 3:45:04 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nbase_df.show(truncate\u003dFalse)",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:45:20 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                          |\n+-------------------------------------------------------------------------------------------------------------------------------+\n|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] \"GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0\" 200 1839     |\n|uplherc.upl.com - - [01/Aug/1995:00:00:07 -0400] \"GET / HTTP/1.0\" 304 0                                                        |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 304 0                               |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/MOSAIC-logosmall.gif HTTP/1.0\" 304 0                             |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/USA-logosmall.gif HTTP/1.0\" 304 0                                |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:09 -0400] \"GET /images/launch-logo.gif HTTP/1.0\" 200 1713                   |\n|uplherc.upl.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/WORLD-logosmall.gif HTTP/1.0\" 304 0                              |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:10 -0400] \"GET /history/skylab/skylab.html HTTP/1.0\" 200 1687                      |\n|piweba4y.prodigy.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/launchmedium.gif HTTP/1.0\" 200 11853                        |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:11 -0400] \"GET /history/skylab/skylab-small.gif HTTP/1.0\" 200 9202                 |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:12 -0400] \"GET /images/ksclogosmall.gif HTTP/1.0\" 200 3635                         |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:12 -0400] \"GET /history/apollo/images/apollo-logo1.gif HTTP/1.0\" 200 1173   |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:13 -0400] \"GET /history/apollo/images/apollo-logo.gif HTTP/1.0\" 200 3047           |\n|uplherc.upl.com - - [01/Aug/1995:00:00:14 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 304 0                               |\n|133.43.96.45 - - [01/Aug/1995:00:00:16 -0400] \"GET /shuttle/missions/sts-69/mission-sts-69.html HTTP/1.0\" 200 10566            |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:17 -0400] \"GET / HTTP/1.0\" 200 7280                                          |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:18 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 200 5866                 |\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:19 -0400] \"GET /history/apollo/apollo-16/apollo-16.html HTTP/1.0\" 200 2743              |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:19 -0400] \"GET /shuttle/resources/orbiters/discovery.html HTTP/1.0\" 200 6849|\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:20 -0400] \"GET /history/apollo/apollo-16/apollo-16-patch-small.gif HTTP/1.0\" 200 14897  |\n+-------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040695665_-1578102591",
      "id": "20180219-034455_1450697740",
      "dateCreated": "Feb 19, 2018 3:44:55 AM",
      "dateStarted": "Feb 19, 2018 3:45:21 AM",
      "dateFinished": "Feb 19, 2018 3:45:24 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import split, regexp_extract\nsplit_df \u003d base_df.select(regexp_extract(\u0027value\u0027, r\u0027^([^\\s]+\\s)\u0027, 1).alias(\u0027host\u0027),\n                          regexp_extract(\u0027value\u0027, r\u0027^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]\u0027, 1).alias(\u0027timestamp\u0027),\n                          regexp_extract(\u0027value\u0027, r\u0027^.*\"\\w+\\s+([^\\s]+)\\s+HTTP.*\"\u0027, 1).alias(\u0027path\u0027),\n                          regexp_extract(\u0027value\u0027, r\u0027^.*\"\\s+([^\\s]+)\u0027, 1).cast(\u0027integer\u0027).alias(\u0027status\u0027),\n                          regexp_extract(\u0027value\u0027, r\u0027^.*\\s+(\\d+)$\u0027, 1).cast(\u0027integer\u0027).alias(\u0027content_size\u0027))\nsplit_df.show(truncate\u003dFalse)",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:46:03 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|host                        |timestamp                 |path                                               |status|content_size|\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|in24.inetnebr.com           |01/Aug/1995:00:00:01 -0400|/shuttle/missions/sts-68/news/sts-68-mcc-05.txt    |200   |1839        |\n|uplherc.upl.com             |01/Aug/1995:00:00:07 -0400|/                                                  |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/ksclogo-medium.gif                         |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/MOSAIC-logosmall.gif                       |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/USA-logosmall.gif                          |304   |0           |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:09 -0400|/images/launch-logo.gif                            |200   |1713        |\n|uplherc.upl.com             |01/Aug/1995:00:00:10 -0400|/images/WORLD-logosmall.gif                        |304   |0           |\n|slppp6.intermind.net        |01/Aug/1995:00:00:10 -0400|/history/skylab/skylab.html                        |200   |1687        |\n|piweba4y.prodigy.com        |01/Aug/1995:00:00:10 -0400|/images/launchmedium.gif                           |200   |11853       |\n|slppp6.intermind.net        |01/Aug/1995:00:00:11 -0400|/history/skylab/skylab-small.gif                   |200   |9202        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:12 -0400|/images/ksclogosmall.gif                           |200   |3635        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:12 -0400|/history/apollo/images/apollo-logo1.gif            |200   |1173        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:13 -0400|/history/apollo/images/apollo-logo.gif             |200   |3047        |\n|uplherc.upl.com             |01/Aug/1995:00:00:14 -0400|/images/NASA-logosmall.gif                         |304   |0           |\n|133.43.96.45                |01/Aug/1995:00:00:16 -0400|/shuttle/missions/sts-69/mission-sts-69.html       |200   |10566       |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:17 -0400|/                                                  |200   |7280        |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:18 -0400|/images/ksclogo-medium.gif                         |200   |5866        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:19 -0400|/history/apollo/apollo-16/apollo-16.html           |200   |2743        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:19 -0400|/shuttle/resources/orbiters/discovery.html         |200   |6849        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:20 -0400|/history/apollo/apollo-16/apollo-16-patch-small.gif|200   |14897       |\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040720627_1605740530",
      "id": "20180219-034520_2091196125",
      "dateCreated": "Feb 19, 2018 3:45:20 AM",
      "dateStarted": "Feb 19, 2018 3:46:03 AM",
      "dateFinished": "Feb 19, 2018 3:46:05 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nprint base_df.filter(base_df[\u0027value\u0027].isNull()).count()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:47:43 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "0\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040763014_-1363889398",
      "id": "20180219-034603_881014827",
      "dateCreated": "Feb 19, 2018 3:46:03 AM",
      "dateStarted": "Feb 19, 2018 3:47:43 AM",
      "dateFinished": "Feb 19, 2018 3:47:50 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nbad_rows_df \u003d split_df.filter(split_df[\u0027host\u0027].isNull() |\n                              split_df[\u0027timestamp\u0027].isNull() |\n                              split_df[\u0027path\u0027].isNull() |\n                              split_df[\u0027status\u0027].isNull() |\n                             split_df[\u0027content_size\u0027].isNull())\n\nprint bad_rows_df.count()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:48:01 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "8756\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040863347_-1897815247",
      "id": "20180219-034743_869808593",
      "dateCreated": "Feb 19, 2018 3:47:43 AM",
      "dateStarted": "Feb 19, 2018 3:48:01 AM",
      "dateFinished": "Feb 19, 2018 3:48:18 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import col, sum\n\ndef count_null(col_name):\n  return sum(col(col_name).isNull().cast(\u0027integer\u0027)).alias(col_name)\n\n# Build up a list of column expressions, one per colum",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:48:42 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1519040881310_-553456618",
      "id": "20180219-034801_1493083192",
      "dateCreated": "Feb 19, 2018 3:48:01 AM",
      "dateStarted": "Feb 19, 2018 3:48:42 AM",
      "dateFinished": "Feb 19, 2018 3:48:42 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nexprs \u003d []\nfor col_name in split_df.columns:\n  exprs.append(count_null(col_name))\n  \nprint exprs",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:48:53 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[Column\u003c(sum(cast(isnull(host) as int)),mode\u003dComplete,isDistinct\u003dfalse) AS host#34\u003e, Column\u003c(sum(cast(isnull(timestamp) as int)),mode\u003dComplete,isDistinct\u003dfalse) AS timestamp#35\u003e, Column\u003c(sum(cast(isnull(path) as int)),mode\u003dComplete,isDistinct\u003dfalse) AS path#36\u003e, Column\u003c(sum(cast(isnull(status) as int)),mode\u003dComplete,isDistinct\u003dfalse) AS status#37\u003e, Column\u003c(sum(cast(isnull(content_size) as int)),mode\u003dComplete,isDistinct\u003dfalse) AS content_size#38\u003e]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040922053_23928888",
      "id": "20180219-034842_885903524",
      "dateCreated": "Feb 19, 2018 3:48:42 AM",
      "dateStarted": "Feb 19, 2018 3:48:53 AM",
      "dateFinished": "Feb 19, 2018 3:48:54 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nsplit_df.agg(*exprs).show()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:50:37 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|        8756|\n+----+---------+----+------+------------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519040933894_-1673968008",
      "id": "20180219-034853_2018742555",
      "dateCreated": "Feb 19, 2018 3:48:53 AM",
      "dateStarted": "Feb 19, 2018 3:50:37 AM",
      "dateFinished": "Feb 19, 2018 3:50:49 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nbad_content_size_df \u003d base_df.filter(~ base_df[\u0027value\u0027].rlike(r\u0027\\d+$\u0027))\n\nprint bad_content_size_df.count()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:51:13 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "8756\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519041037017_1741817403",
      "id": "20180219-035037_1926279887",
      "dateCreated": "Feb 19, 2018 3:50:37 AM",
      "dateStarted": "Feb 19, 2018 3:51:14 AM",
      "dateFinished": "Feb 19, 2018 3:51:21 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import lit, concat\n\nbad_content_size_df.select(concat(bad_content_size_df[\u0027value\u0027], lit(\u0027$\u0027))).show(truncate\u003dFalse)",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:51:31 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------------------------------------------------------------------------------------------------------------------------+\n|concat(value,$)                                                                                                             |\n+----------------------------------------------------------------------------------------------------------------------------+\n|gw1.att.com - - [01/Aug/1995:00:03:53 -0400] \"GET /shuttle/missions/sts-73/news HTTP/1.0\" 302 -$                            |\n|js002.cc.utsunomiya-u.ac.jp - - [01/Aug/1995:00:07:33 -0400] \"GET /shuttle/resources/orbiters/discovery.gif HTTP/1.0\" 404 -$|\n|tia1.eskimo.com - - [01/Aug/1995:00:28:41 -0400] \"GET /pub/winvn/release.txt HTTP/1.0\" 404 -$                               |\n|itws.info.eng.niigata-u.ac.jp - - [01/Aug/1995:00:38:01 -0400] \"GET /ksc.html/facts/about_ksc.html HTTP/1.0\" 403 -$         |\n|grimnet23.idirect.com - - [01/Aug/1995:00:50:12 -0400] \"GET /www/software/winvn/winvn.html HTTP/1.0\" 404 -$                 |\n|miriworld.its.unimelb.edu.au - - [01/Aug/1995:01:04:54 -0400] \"GET /history/history.htm HTTP/1.0\" 404 -$                    |\n|ras38.srv.net - - [01/Aug/1995:01:05:14 -0400] \"GET /elv/DELTA/uncons.htm HTTP/1.0\" 404 -$                                  |\n|cs1-06.leh.ptd.net - - [01/Aug/1995:01:17:38 -0400] \"GET /sts-71/launch/\" 404 -$                                            |\n|www-b2.proxy.aol.com - - [01/Aug/1995:01:22:07 -0400] \"GET /shuttle/countdown HTTP/1.0\" 302 -$                              |\n|maui56.maui.net - - [01/Aug/1995:01:31:56 -0400] \"GET /shuttle HTTP/1.0\" 302 -$                                             |\n|dialip-24.athenet.net - - [01/Aug/1995:01:33:02 -0400] \"GET /history/apollo/apollo-13.html HTTP/1.0\" 404 -$                 |\n|h96-158.ccnet.com - - [01/Aug/1995:01:35:50 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -$        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:23 -0400] \"GET /history/apollo/a-001/movies/ HTTP/1.0\" 404 -$                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:30 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -$        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:38 -0400] \"GET /history/apollo/a-001/movies/ HTTP/1.0\" 404 -$                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:42 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -$        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:44 -0400] \"GET /history/apollo/a-001/images/ HTTP/1.0\" 404 -$                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:47 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -$        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:37:04 -0400] \"GET /history/apollo/a-004/a-004-patch-small.gif HTTP/1.0\" 404 -$        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:37:05 -0400] \"GET /history/apollo/a-004/movies/ HTTP/1.0\" 404 -$                      |\n+----------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519041073242_-1660670363",
      "id": "20180219-035113_1893332390",
      "dateCreated": "Feb 19, 2018 3:51:13 AM",
      "dateStarted": "Feb 19, 2018 3:51:32 AM",
      "dateFinished": "Feb 19, 2018 3:51:34 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\n# Replace all null content_size values with 0.\ncleaned_df \u003d split_df.fillna({\u0027content_size\u0027: 0})\n\n# Ensure that there are no nulls left.\nexprs \u003d []\nfor col_name in cleaned_df.columns:\n  exprs.append(count_null(col_name))\n\ncleaned_df.agg(*exprs).show()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:59:34 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|           0|\n+----+---------+----+------+------------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519041548732_1482416734",
      "id": "20180219-035908_780415976",
      "dateCreated": "Feb 19, 2018 3:59:08 AM",
      "dateStarted": "Feb 19, 2018 3:59:34 AM",
      "dateFinished": "Feb 19, 2018 3:59:42 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom pyspark.sql.functions import udf\n\nmonth_map \u003d {\n  \u0027Jan\u0027: 1, \u0027Feb\u0027: 2, \u0027Mar\u0027:3, \u0027Apr\u0027:4, \u0027May\u0027:5, \u0027Jun\u0027:6, \u0027Jul\u0027:7,\n  \u0027Aug\u0027:8,  \u0027Sep\u0027: 9, \u0027Oct\u0027:10, \u0027Nov\u0027: 11, \u0027Dec\u0027: 12\n}\n\ndef parse_clf_time(s):\n    \"\"\" Convert Common Log time format into a Python datetime object\n    Args:\n        s (str): date and time in Apache time format [dd/mmm/yyyy:hh:mm:ss (+/-)zzzz]\n    Returns:\n        a string suitable for passing to CAST(\u0027timestamp\u0027)\n    \"\"\"\n    # NOTE: We\u0027re ignoring time zone here. In a production application, you\u0027d want to handle that.\n    return \"{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}\".format(\n      int(s[7:11]),\n      month_map[s[3:6]],\n      int(s[0:2]),\n      int(s[12:14]),\n      int(s[15:17]),\n      int(s[18:20])\n    )\n\nu_parse_time \u003d udf(parse_clf_time)\n\nlogs_df \u003d cleaned_df.select(\u0027*\u0027, u_parse_time(cleaned_df[\u0027timestamp\u0027]).cast(\u0027timestamp\u0027).alias(\u0027time\u0027)).drop(\u0027timestamp\u0027)\ntotal_log_entries \u003d logs_df.count()\n\nprint total_log_entries",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 3:59:47 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1043177\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519041091734_1488914782",
      "id": "20180219-035131_1712448261",
      "dateCreated": "Feb 19, 2018 3:51:31 AM",
      "dateStarted": "Feb 19, 2018 3:59:47 AM",
      "dateFinished": "Feb 19, 2018 4:00:12 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nlogs_df.printSchema()",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 4:00:29 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- host: string (nullable \u003d true)\n |-- path: string (nullable \u003d true)\n |-- status: integer (nullable \u003d true)\n |-- content_size: integer (nullable \u003d false)\n |-- time: timestamp (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1519041485474_-1765941608",
      "id": "20180219-035805_1405503179",
      "dateCreated": "Feb 19, 2018 3:58:05 AM",
      "dateStarted": "Feb 19, 2018 4:00:29 AM",
      "dateFinished": "Feb 19, 2018 4:00:29 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "Feb 19, 2018 4:00:29 AM",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1519041629227_1879801051",
      "id": "20180219-040029_2035206604",
      "dateCreated": "Feb 19, 2018 4:00:29 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "sample/spark_weblog_analysis",
  "id": "2D62921PB",
  "angularObjects": {
    "2D6KMVEJB:shared_process": [],
    "2D8YST44Q:shared_process": [],
    "2D5NEKACD:shared_process": [],
    "2D78MJMJ8:shared_process": [],
    "2D6S9AZBV:shared_process": [],
    "2D6J9P331:shared_process": [],
    "2D69DCA51:shared_process": [],
    "2D5RQMZNF:shared_process": [],
    "2D5NCQX94:shared_process": [],
    "2D78X28BR:shared_process": [],
    "2D6EDPEV7:shared_process": [],
    "2D6KYQ1JZ:shared_process": [],
    "2D71SGCS3:shared_process": [],
    "2D5FSYRWA:shared_process": [],
    "2D8FSEPU6:shared_process": [],
    "2D7DCUW2A:shared_process": [],
    "2D81WJGBZ:shared_process": [],
    "2D6PQ5G9Q:shared_process": [],
    "2D767KM18:shared_process": [],
    "2D8YQ3A7W:shared_process": [],
    "2D8Z2R4XC:shared_process": []
  },
  "config": {},
  "info": {}
}